<!DOCTYPE html>
<html lang="en-uk">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="Timothy Hyndman">
  <meta name="description" content="Introduction I have been wanting to teach myself about &ldquo;Deep Q-Learning&rdquo; for a while, and I thought tic-tac-toe was the perfect toy problem to start with. Tic-tac-toe is particularly friendly because:">
  
  <meta property="og:title" content="Building a tictactoe AI using reinforcement learning" />
<meta property="og:description" content="Introduction I have been wanting to teach myself about &ldquo;Deep Q-Learning&rdquo; for a while, and I thought tic-tac-toe was the perfect toy problem to start with. Tic-tac-toe is particularly friendly because:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/tictactoe_ai/" />
<meta property="article:published_time" content="2023-04-07T16:33:09+10:00" />
<meta property="article:modified_time" content="2023-04-07T16:33:09+10:00" />


  <title>
  
       Building a tictactoe AI using reinforcement learning | Timothy Hyndman 
  
  </title>

  <link rel="canonical" href="/tictactoe_ai/">

  
  

  
  <link href="/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600">
  <link href="/css/font.css" rel="stylesheet"> 
    
  
  <link href="/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="/css/main.css" rel="stylesheet">


  
  <link rel="shortcut icon"
  
      href="/img/icon-small.jpg"
  
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
    
    <link rel="stylesheet" href="/js/vendors/katex/katex.min.css">
  
  

  
    
    <link rel="stylesheet" href="/css/vendors/highlight/github-gist.css">
  

</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    
    

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="/">
          
        <img class="avatar" src="/img/icon-small.jpg" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        
        <strong> Timothy Hyndman</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="/">Home</a>
          </li>
             
            <li class="nav-item ">
              <a class="nav-link" href="/CV.pdf" >CV  </a>
            </li>
          
          
        </ul>

      </div>

    </div>
  </nav>
  
 
      
 






<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('/img/header-slides/earnslaw.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('/img/header-slides//paradise.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="/">
          
            <img class="pull-right avatar avatar-md" src="/img/icon-small.jpg" alt="" >
          
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="/">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>Timothy Hyndman</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
              <a href="//github.com/timothyhyndman" target="_blank" rel="noopener"><i class="fab fa-github pr-1" aria-hidden="true"></i></a>    
            
            
              <a href="//linkedin.com/in/timothy-hyndman" target="_blank" rel="noopener"><i class="fab fa-linkedin pr-1" aria-hidden="true"></i></a>
            

            

            

            

            
    
            
    
        
            
                <a href="mailto:timothyhyndman@gmail.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>
  
    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="container pr-5">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
    
  </ul>

  <div class="px-4 post-heading">Building a tictactoe AI using reinforcement learning</div>

  <ul class="post-meta li-x mt-1">
    
      <li>Apr 7, 2023</li>
    

    
  </ul>
  

</div>


          <div class="post-content markdown">
            <h2 id="introduction">Introduction</h2>
<p>I have been wanting to teach myself about &ldquo;Deep Q-Learning&rdquo; for a while, and I thought tic-tac-toe was the perfect toy problem to start with. Tic-tac-toe is particularly friendly because:</p>
<ul>
<li>It is easy as a human to evaluate if the AI is playing optimally.</li>
<li>There are only 5477 possible board states, so the AI will most likely see almost all of the states during training.</li>
</ul>
<p>This second point is particularly useful because we don&rsquo;t have to worry about overfitting - it doesn&rsquo;t matter if the AI memorises the correct response to every possible board, because there&rsquo;s nothing outside the training data that it needs to generalise to.</p>
<h2 id="try-it-out">Try it out</h2>
<p>To get the details on how the AI was trained you can <a href="https://github.com/TimothyHyndman/tictactoe">view my code</a> on github.</p>
<p>You can play the AI for yourself below. To make a move, simply click on one of the squares. The AI will then make its move, and the game will continue until one player wins or the game ends in a draw.</p>
<head>
    <link rel="stylesheet" href='/tictactoe/static/css/main.css' />
    <!-- Import TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <!-- Import tfjs-vis -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
</head>
<body>
    <script type="module" src='/tictactoe/game.js' defer></script>
    <div class="game_container">
        <div class="board">
            <div class="square" data-value="0"></div>
            <div class="square" data-value="1"></div>
            <div class="square" data-value="2"></div>
            <div class="square" data-value="3"></div>
            <div class="square" data-value="4"></div>
            <div class="square" data-value="5"></div>
            <div class="square" data-value="6"></div>
            <div class="square" data-value="7"></div>
            <div class="square" data-value="8"></div>
        </div>
    </div>
    <div class="game-over">
        <div class="game-over-text"></div>
        <button class="restart">Play again</button>
    </div>
</body>
<h2 id="details">Details</h2>
<p>The AI above uses a fully connected Neural Network with 3 hidden layers of 64 neurons each. The input to this network is the board state, and the output is 9 neurons representing a probability distribution of moves to play (one neuron for each square). The AI can play by either sampling the moves according to the calculated probability, or by choosing the highest probability move. I use the latter above, and the former when training.</p>
<p>Training is done in sets of 250 games each, with the AI playing an even mix of games as &lsquo;X&rsquo; and &lsquo;O&rsquo; against itself. After each set of games, the neural network is updated using training data from the last 5000 games.</p>
<p>A very rough evaluation of the quality of the AI is calculated by playing 400 games against a player who chooses moves uniformly at random, and then calculating the percentage of games won out of all games that weren&rsquo;t drawn. The above AI reached a win-percentage of 100%.</p>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
            </div>
            
          </div>
          

          
          <div class="row pt-3">
            <div class="col-md-6">
              
            </div>
            
            <div class="col-md-6 text-right" >
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      

    </div>
    


  </main>
  


    
    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
      <a href="//github.com/timothyhyndman " target="_blank" rel="noopener"><i class="fab fa-github mr-3" aria-hidden="true"></i></a>    
    
    
      <a href="//linkedin.com/in/timothy-hyndman" target="_blank" rel="noopener"><i class="fab fa-linkedin-in mr-3" aria-hidden="true"></i></a>
    

    

    

    

    

    


    
        <a href="mailto:timothyhyndman@gmail.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
    <span>  2016 - 2023 &copy; | Theme <a href='https://github.com/orianna-zzo/AllinOne' target="_blank">AllinOne</a> by <a href='https://github.com/orianna-zzo' target="_blank">Orianna</a>  </span>
  </div>
  

</footer>


    






<script type="text/javascript" src="/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="/js/main.js"></script>



  
  <script src="/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>




 
  <script src="/js/vendors/katex/katex.min.js"> </script>
  <script src="/js/vendors/katex/contrib/auto-render.min.js"></script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {
          renderMathInElement(document.body);
      });
  </script>






<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-50CMXZPL44', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



<script type="text/javascript">
  
  new WOW().init();
</script>




  </body>
</html>